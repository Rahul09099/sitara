<!DOCTYPE html>
<html>
<head>
    <title>User Search Tool</title>
    <style>
        body { font-family: Arial; background: #f4f6f9; padding: 20px; }
        textarea { width: 100%; height: 120px; }
        button { margin: 5px 5px 5px 0; padding: 6px 12px; }
        .box { background: #fff; padding: 15px; margin-top: 15px; border-radius: 6px; }
    </style>
</head>
<body>

<h2>ğŸ” Search Users</h2>

<input id="searchKey" placeholder="Enter search key" />
<button onclick="search()">Search</button>

<div id="output"></div>

<script>
const API = "https://sudig-km1b.onrender.com";

function copyText(id) {
    const el = document.getElementById(id);
    el.select();
    document.execCommand("copy");
    alert("Copied!");
}

function search() {
    const key = document.getElementById("searchKey").value;
    fetch(`${API}/search?key=${key}`)
        .then(res => res.json())
        .then(data => {
            document.getElementById("output").innerHTML = `
                ${makeBox("Phones", "phones", data.phones, key)}
                ${makeBox("Registration IDs", "regs", data.registration_ids, key)}
                ${makeBox("Emails", "emails", data.emails, key)}
            `;
        });
}

function makeBox(title, id, list, key) {
    return `
    <div class="box">
        <h3>${title}</h3>
        <textarea id="${id}">${list.join("\n")}</textarea><br>
        <button onclick="copyText('${id}')">ğŸ“‹ Copy</button>
        <a href="${API}/download?key=${key}&type=${title.includes('Phone') ? 'phones' : title.includes('Registration') ? 'reg' : 'full'}">
            <button>â¬‡ï¸ Download</button>
        </a>
    </div>
    `;
}
</script>

</body>
</html>
